<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>æ‚£è€…å…¥å®¤ï¼ˆPatient Entryï¼‰éŸ³å£°ã‚¬ã‚¤ãƒ‰</title>
<style>
body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Hiragino Sans","Segoe UI",sans-serif;
background:linear-gradient(180deg,#f7fbff,#eef6ff);color:#0f172a;}
.header{padding:18px 16px 10px;}
.frame-title{border:2px solid #38bdf8;padding:14px 16px;border-radius:14px;background:#f8fcff;text-align:center;}
.frame-title h1{margin:0;font-size:20px;}
.frame-title p{margin:6px 0 0;font-size:14px;color:#475569;}
.note{font-size:12px;color:#475569;margin:12px 16px;}
.main{margin:0 16px 24px;padding:16px;background:#fff;border-radius:18px;box-shadow:0 8px 18px rgba(15,23,42,.08);}
.row{display:flex;gap:10px;align-items:center;flex-wrap:wrap;}
select{flex:1;max-width:100%;font-size:16px;padding:10px 36px 10px 12px;border-radius:12px;border:1px solid #cbd5f5;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
button{font-size:15px;padding:10px 14px;border-radius:12px;border:1px solid #cbd5f5;background:#eff6ff;}
button:active{transform:scale(.98);}
.label{margin-top:14px;font-size:13px;color:#475569;}
.jp{font-size:18px;font-weight:600;margin-top:6px;}
.en{font-size:16px;margin-top:4px;}
.controls{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px;}
audio{width:100%;margin-top:10px;}
.status{margin-top:8px;font-size:13px;color:#475569;}
.hint{margin-top:10px;font-size:12px;color:#64748b;}

.device-details{margin-top:10px;border:1px solid #cbd5f5;border-radius:14px;background:#f8fcff;padding:10px 12px;}
.device-summary{cursor:pointer;font-size:14px;color:#0f172a;list-style:none;}
.device-summary::-webkit-details-marker{display:none;}
.device-list{display:flex;flex-direction:column;gap:10px;margin-top:10px;}
.device-btn{font-size:15px;padding:12px 14px;border-radius:12px;border:1px solid #cbd5f5;background:#eff6ff;text-align:left;}
.device-btn:active{transform:scale(.98);}
.device-btn.is-selected{border-color:#38bdf8;box-shadow:0 0 0 3px rgba(56,189,248,.25);background:#e0f2fe;}


/* === Implant Device Modal (emergency-style sheet) === */
.fab-dev{position:fixed;left:16px;bottom:16px;z-index:10000;
background:#f8fcff;border:2px solid #38bdf8;color:#0f172a;
border-radius:14px;padding:12px 14px;font-weight:800}
.dev-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.35);
z-index:9998;display:none}
.dev-sheet{position:fixed;left:0;right:0;bottom:0;z-index:9999;
display:none;padding:12px 12px 18px}
.dev-panel{max-width:860px;margin:0 auto;background:#fff;
border-radius:20px;padding:12px 12px 14px;box-shadow:0 18px 40px rgba(15,23,42,.25)}
.dev-list{display:flex;flex-direction:column;gap:10px;max-height:52vh;overflow:auto;padding:4px}
.dev-item{border:1px solid #e2e8f0;border-radius:16px;padding:12px 12px;background:#ffffff}
.dev-item:active{transform:scale(.99)}
.dev-item.is-active{border-color:#38bdf8;box-shadow:0 0 0 3px rgba(56,189,248,.18)}
.dev-jp{font-weight:800;font-size:16px;line-height:1.25}
.dev-en{font-size:13px;color:#475569;margin-top:4px;line-height:1.25}
.dev-audio{margin-top:12px}
.dev-footer{display:flex;justify-content:space-between;gap:10px;align-items:center;margin-top:10px}
.dev-close{background:#eff6ff;border:1px solid #cbd5f5;border-radius:14px;padding:10px 14px;font-size:15px}
.dev-title{font-size:12px;color:#64748b;margin:0 0 8px 6px}


/* Nitro Image Sheet */
.img-thumb-btn{
  margin-top:12px;
  width:100%;
  font-weight:700;
  background:#f8fcff;
  border:2px solid #38bdf8;
  border-radius:14px;
}

</style>
</head>
<body>
<div class="header">
  <div class="frame-title">
    <h1>æ‚£è€…å…¥å®¤ï¼ˆPatient Entryï¼‰</h1>
    <p>English Audio Guide</p>
  </div>
</div>

<p class="note">â€» iPhone / iPad / Android ã§å†ç”Ÿã§ãã¾ã™ã€‚æœ€åˆã¯ã€Œå†ç”Ÿã€ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚</p>

<div class="main">
  <div class="row">
    <select id="sel"></select>
    <button id="prev">â† å‰</button>
    <button id="next">æ¬¡ â†’</button>
  </div>

  <div class="label">æ—¥æœ¬èªï¼ˆå†…å®¹ï¼‰</div>
  <div class="jp" id="jp"></div>

  <div class="label">English (Script)</div>
  <div class="en" id="en"></div>

  <div class="controls">
    <button id="play">â–¶ï¸ å†ç”Ÿ</button>
    <button id="pause">â¸ ä¸€æ™‚åœæ­¢</button>
    <button id="replay">â†» ã‚‚ã†ä¸€åº¦</button>
  </div>

  <div class="controls" style="margin-top:12px;">
    <button class="img-thumb-btn" id="nitroImgOpen">ğŸ–¼ ãƒ‹ãƒˆãƒ­ãƒšãƒ³æŠ•ä¸ã‚¤ãƒ¡ãƒ¼ã‚¸å›³</button>
  </div>

  <div class="status" id="status">å¾…æ©Ÿä¸­ / Ready</div>
  <audio id="player" controls></audio>

  <div class="hint">
    å†ç”Ÿã§ããªã„å ´åˆï¼šæ¶ˆéŸ³ãƒ¢ãƒ¼ãƒ‰è§£é™¤ã€éŸ³é‡ã€Bluetoothæ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚
  </div>
</div>

<script>
const STEPS = [
 {preview:"æœ¬æ—¥ã®é€šè¨³ã¯ã™ã§ã«é€€å‹¤ã—ã¦ã„ã¾ã™â€¦", jp:"æœ¬æ—¥ã®é€šè¨³ã¯ã™ã§ã«é€€å‹¤ã—ã¦ã„ã¾ã™ã®ã§ã€è‹±èªã®ã‚¬ã‚¤ãƒ‰ã‚’ä½¿ã£ã¦èª¬æ˜ã—ã¾ã™ã€‚", en:"Our interpreter has already left for the day, so I'll explain using an English guide."},
 {preview:"åˆ†ã‹ã‚‰ãªã„ã“ã¨ãŒã‚ã‚Œã°â€¦", jp:"åˆ†ã‹ã‚‰ãªã„ã“ã¨ãŒã‚ã‚Œã°ã€ã„ã¤ã§ã‚‚è¨€ã£ã¦ãã ã•ã„ã€‚", en:"Please let me know if anything is unclear."},
 {preview:"ç”Ÿå¹´æœˆæ—¥ã‚’æ•™ãˆã¦ãã ã•ã„â€¦", jp:"ç”Ÿå¹´æœˆæ—¥ã‚’æ•™ãˆã¦ã„ãŸã ã‘ã¾ã™ã‹ï¼Ÿ", en:"Could you tell me your date of birth?"},
 {preview:"å¿ƒè‡“ãƒ‡ãƒã‚¤ã‚¹ã®ç¢ºèªâ€¦", jp:"èƒ¸ã«ãƒšãƒ¼ã‚¹ãƒ¡ãƒ¼ã‚«ãƒ¼ã€ICDã€CRTãªã©ã®å¿ƒè‡“ãƒ‡ãƒã‚¤ã‚¹ã¯å…¥ã£ã¦ã„ã¾ã™ã‹ï¼Ÿ", en:"Do you have any heart devices in your chest, like a pacemaker, ICD, or CRT?"},
 {preview:"ãƒ™ãƒƒãƒ‰ã«åº§ã£ã¦ãã ã•ã„â€¦", jp:"ãƒ™ãƒƒãƒ‰ã«åº§ã£ã¦ã€é´ã‚’è„±ã„ã§ãã ã•ã„ã€‚", en:"Please sit on the bed and take off your shoes."},
 {preview:"ä»°å‘ã‘ã«å¯ã¦ãã ã•ã„â€¦", jp:"ãƒ™ãƒƒãƒ‰ã«ä»°å‘ã‘ã§å¯ã¦ãã ã•ã„ã€‚", en:"Please lie on your back on the bed."},
 {preview:"é ­ã¨è¶³ã®ä½ç½®â€¦", jp:"é ­ã¯ã“ã“ã€è¶³ã¯ã‚ã¡ã‚‰ã§ã™ã€‚", en:"Your head goes here, and your feet go there."},
 {preview:"ç«‹ã¡ä¸ŠãŒã£ã¦åº§ã‚‹â€¦", jp:"ã‚†ã£ãã‚Šç«‹ã¡ä¸ŠãŒã£ã¦ã€ãƒ™ãƒƒãƒ‰ã«åº§ã£ã¦ãã ã•ã„ã€‚", en:"Please stand up slowly and sit on the bed."},
 {preview:"ã‚¹ãƒ©ã‚¤ãƒ‰ãƒœãƒ¼ãƒ‰â€¦", jp:"èƒŒä¸­ã®å¾Œã‚ã«ã‚¹ãƒ©ã‚¤ãƒ‰ãƒœãƒ¼ãƒ‰ã‚’å…¥ã‚Œã¾ã™ã­ã€‚", en:"I'll put a slide board behind your back."},
 {preview:"ãƒ™ãƒƒãƒ‰ã¸ç§»å‹•â€¦", jp:"ã“ã‚Œã‹ã‚‰ãƒ™ãƒƒãƒ‰ã«ç§»ã‚Šã¾ã™ã­ã€‚", en:"Let me slide you onto the bed now."},
 {preview:"å°‘ã—ä¸Šã«â€¦", jp:"å°‘ã—ä¸Šã«ãšã‚Œã¦ãã ã•ã„ã€‚", en:"Please slide up a little."},
 {preview:"å°‘ã—ä¸‹ã«â€¦", jp:"å°‘ã—ä¸‹ã«ãšã‚Œã¦ãã ã•ã„ã€‚", en:"Please slide down a little."},
 {preview:"ä¸Šã«ç§»å‹•â€¦", jp:"å°‘ã—ä¸Šã«ç§»å‹•ã—ã¾ã™ã­ã€‚", en:"I'll slide you up a little."},
 {preview:"ä¸‹ã«ç§»å‹•â€¦", jp:"å°‘ã—ä¸‹ã«ç§»å‹•ã—ã¾ã™ã­ã€‚", en:"I'll slide you down a little."},
 {preview:"é¦–ã¯å¤§ä¸ˆå¤«ï¼Ÿ", jp:"é¦–ã¯ã¤ã‚‰ããªã„ã§ã™ã‹ï¼Ÿ", en:"Is your neck comfortable?"},
 {preview:"é«˜ã•ã®ç¢ºèªâ€¦", jp:"é«˜ã™ããŸã‚Šä½ã™ããŸã‚Šã—ã¾ã›ã‚“ã‹ï¼Ÿ", en:"Is it not too high or low?"},
 {preview:"ãƒ™ãƒƒãƒ‰ãŒå‹•ãã¾ã™â€¦", jp:"ãƒ™ãƒƒãƒ‰ãŒå‹•ãã¾ã™ã®ã§ã€å‹•ã‹ãªã„ã§ãã ã•ã„ã€‚", en:"The bed will move now, so please stay still."}
];

const sel=document.getElementById('sel'),
jp=document.getElementById('jp'),
en=document.getElementById('en'),
player=document.getElementById('player'),
status=document.getElementById('status');

STEPS.forEach((s,i)=>{
 const o=document.createElement('option');
 o.value=i;
 o.textContent=`${String(i+1).padStart(2,'0')}ï½œ${s.jp}`;
 sel.appendChild(o);
});

let idx=0;
function load(i){
 idx=Math.max(0,Math.min(STEPS.length-1,i));
 sel.value=idx;
 jp.textContent=STEPS[idx].jp;
 en.textContent=STEPS[idx].en;
 player.src=`audio/step_${String(idx+1).padStart(2,'0')}.m4a`;
 status.textContent="å¾…æ©Ÿä¸­ / Ready";
}
sel.onchange=()=>load(parseInt(sel.value));
document.getElementById('prev').onclick=()=>load(idx-1);
document.getElementById('next').onclick=()=>load(idx+1);
document.getElementById('play').onclick=()=>player.play();
document.getElementById('pause').onclick=()=>player.pause();
document.getElementById('replay').onclick=()=>{player.currentTime=0;player.play();}
player.onplay=()=>status.textContent="å†ç”Ÿä¸­ / Playing";
player.onpause=()=>status.textContent="ä¸€æ™‚åœæ­¢ / Paused";
player.onended=()=>status.textContent="å¾…æ©Ÿä¸­ / Ready";


load(0);


document.addEventListener('DOMContentLoaded',()=>{
  const DEV=[
    {jp:'PMã€CRT-P ã‚ã‚Šã®å ´åˆï¼šã§ã¯æ¤œæŸ»å¾Œã«å¿ƒè‡“ã®æ©Ÿå™¨ã‚’ç¢ºèªã—ã¦ã€æ­£å¸¸ã«ä½œå‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¾ã™ã­ã€‚',
     en:"Okay, weâ€™ll check your heart device after the test to confirm everything is functioning properly.",
     a:'audio/device_01_pm_crtp.m4a'},
    {jp:'ICDã€CRT-D ã‚ã‚Šã®å ´åˆï¼šã§ã¯æ¤œæŸ»ã®å‰å¾Œã«å¿ƒè‡“ã®æ©Ÿå™¨ã‚’ç¢ºèªã—ã¦ã€æ­£å¸¸ã«ä½œå‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¾ã™ã­ã€‚',
     en:"Okay, weâ€™ll check your heart device before and after the test to confirm everything is functioning properly.",
     a:'audio/device_02_icd_crtd.m4a'},
    {jp:'ä»Šã‹ã‚‰å¿ƒè‡“ã®æ©Ÿå™¨ã®ãƒã‚§ãƒƒã‚¯ã‚’ã—ã¾ã™ã­ã€‚æ‹…å½“è€…ãŒæ¥ã‚‹ã¾ã§å°‘ã—ãŠå¾…ã¡ãã ã•ã„ã€‚',
     en:"Weâ€™ll check your heart device now. Please wait here for a moment until the staff arrives.",
     a:'audio/device_03_wait_for_staff.m4a'}
  ];

  const open=document.getElementById('devOpen');
  const back=document.getElementById('devBackdrop');
  const sheet=document.getElementById('devSheet');
  const list=document.getElementById('devList');
  const player=document.getElementById('devPlayer');
  const close=document.getElementById('devClose');

  if(!open || !back || !sheet || !list || !player || !close) return;

  const show=()=>{back.style.display='block';sheet.style.display='block';open.style.display='none';};
  const hide=()=>{back.style.display='none';sheet.style.display='none';open.style.display='';};

  DEV.forEach((s,i)=>{
    const d=document.createElement('div');
    d.className='dev-item';
    d.innerHTML=`<div class="dev-jp">${i+1}. ${s.jp}</div>
                 <div class="dev-en">${s.en}</div>`;
    d.addEventListener('click',()=>{
      list.querySelectorAll('.dev-item').forEach(x=>x.classList.remove('is-active'));
      d.classList.add('is-active');
      player.src=s.a;
      player.play();
    });
    list.appendChild(d);
  });

  open.addEventListener('click', show);
  close.addEventListener('click', hide);
  back.addEventListener('click', hide);

  document.addEventListener('keydown',(e)=>{
    if(e.key==='Escape') hide();
  });
});

</script>

<button class="fab-dev" id="devOpen">æ¤ãˆè¾¼ã¿ãƒ‡ãƒã‚¤ã‚¹ãŒã‚ã‚‹å ´åˆ</button>
<div class="dev-backdrop" id="devBackdrop"></div>
<div class="dev-sheet" id="devSheet" role="dialog" aria-modal="true" aria-label="implant device">
  <div class="dev-panel">
    <div class="dev-title">æ¤ãˆè¾¼ã¿ãƒ‡ãƒã‚¤ã‚¹ãŒã‚ã‚‹å ´åˆ / If you have an implanted heart device</div>
    <div class="dev-list" id="devList"></div>

    <div class="dev-audio">
      <audio id="devPlayer" controls style="width:100%"></audio>
    </div>

    <div class="dev-footer">
      <button class="dev-close" id="devClose" type="button">é–‰ã˜ã‚‹</button>
      <div style="font-size:12px;color:#64748b;">ã‚¿ãƒƒãƒ—ã§å†ç”Ÿ / Tap to play</div>
    </div>
  </div>
</div>


<div class="dev-backdrop" id="nitroImgBackdrop"></div>
<div class="dev-sheet" id="nitroImgSheet" role="dialog" aria-modal="true">
  <div class="dev-panel">
    <div class="dev-title">ãƒ‹ãƒˆãƒ­ãƒšãƒ³æŠ•ä¸ã‚¤ãƒ¡ãƒ¼ã‚¸å›³</div>
    <div style="padding:6px;">
      <img src="img/nitropen_image.jpg"
           alt="ãƒ‹ãƒˆãƒ­ãƒšãƒ³æŠ•ä¸ã‚¤ãƒ¡ãƒ¼ã‚¸å›³"
           style="width:100%;max-height:55vh;object-fit:contain;border-radius:14px;background:#0b1220;">
    </div>
    <div class="dev-footer">
      <button class="dev-close" id="nitroImgClose">é–‰ã˜ã‚‹</button>
      <div style="font-size:12px;color:#64748b;">èˆŒã®ä¸‹ã«å…¥ã‚Œã¾ã™</div>
    </div>
  </div>
</div>

</body>
</html>
